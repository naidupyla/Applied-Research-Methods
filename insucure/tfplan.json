{"format_version":"1.2","terraform_version":"1.8.5","variables":{"insecure_admin_password":{"value":"P@ssword1234!"},"location":{"value":"westeurope"},"prefix":{"value":"policyascodedemo"},"tags":{"value":{"phase":"insecure","project":"policy-as-code-demo"}}},"planned_values":{"outputs":{"key_vault_name":{"sensitive":false,"type":"string","value":"policyascodedemo-kv"},"resource_group":{"sensitive":false,"type":"string","value":"policyascodedemo-rg"},"storage_account_name":{"sensitive":false,"type":"string","value":"policyascodedemosa"}},"root_module":{"resources":[{"address":"azurerm_key_vault.kv","mode":"managed","type":"azurerm_key_vault","name":"kv","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":2,"values":{"enable_rbac_authorization":null,"enabled_for_deployment":null,"enabled_for_disk_encryption":null,"enabled_for_template_deployment":null,"location":"westeurope","name":"policyascodedemo-kv","network_acls":[{"bypass":"AzureServices","default_action":"Allow","ip_rules":null,"virtual_network_subnet_ids":null}],"public_network_access_enabled":true,"purge_protection_enabled":false,"resource_group_name":"policyascodedemo-rg","sku_name":"standard","soft_delete_retention_days":90,"tags":{"phase":"insecure","project":"policy-as-code-demo"},"tenant_id":"5318eefe-8bca-4f0f-a115-d1a32583e5e9","timeouts":null},"sensitive_values":{"access_policy":[],"contact":[],"network_acls":[{}],"tags":{}}},{"address":"azurerm_key_vault_access_policy.me","mode":"managed","type":"azurerm_key_vault_access_policy","name":"me","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"application_id":null,"certificate_permissions":null,"key_permissions":null,"object_id":"64605817-ce31-4aee-b339-acb85b45dea0","secret_permissions":["Get","Set","List","Delete"],"storage_permissions":null,"tenant_id":"5318eefe-8bca-4f0f-a115-d1a32583e5e9","timeouts":null},"sensitive_values":{"secret_permissions":[false,false,false,false]}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"additional_capabilities":[],"admin_password":"P@ssword1234!","admin_ssh_key":[],"admin_username":"azureuser","allow_extension_operations":true,"availability_set_id":null,"boot_diagnostics":[],"bypass_platform_safety_checks_on_user_schedule_enabled":false,"capacity_reservation_group_id":null,"custom_data":null,"dedicated_host_group_id":null,"dedicated_host_id":null,"disable_password_authentication":false,"edge_zone":null,"encryption_at_host_enabled":null,"eviction_policy":null,"extensions_time_budget":"PT1H30M","gallery_application":[],"identity":[],"license_type":null,"location":"westeurope","max_bid_price":-1,"name":"policyascodedemo-vm","os_disk":[{"caching":"ReadWrite","diff_disk_settings":[],"disk_encryption_set_id":null,"secure_vm_disk_encryption_set_id":null,"security_encryption_type":null,"storage_account_type":"Standard_LRS","write_accelerator_enabled":false}],"os_image_notification":[],"patch_assessment_mode":"ImageDefault","patch_mode":"ImageDefault","plan":[],"platform_fault_domain":-1,"priority":"Regular","provision_vm_agent":true,"proximity_placement_group_id":null,"reboot_setting":null,"resource_group_name":"policyascodedemo-rg","secret":[],"secure_boot_enabled":null,"size":"Standard_B1s","source_image_id":null,"source_image_reference":[{"offer":"0001-com-ubuntu-server-jammy","publisher":"Canonical","sku":"22_04-lts","version":"latest"}],"tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null,"user_data":null,"virtual_machine_scale_set_id":null,"vtpm_enabled":null,"zone":null},"sensitive_values":{"additional_capabilities":[],"admin_password":true,"admin_ssh_key":[],"boot_diagnostics":[],"custom_data":true,"gallery_application":[],"identity":[],"network_interface_ids":[],"os_disk":[{"diff_disk_settings":[]}],"os_image_notification":[],"plan":[],"private_ip_addresses":[],"public_ip_addresses":[],"secret":[],"source_image_reference":[{}],"tags":{},"termination_notification":[]}},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"accelerated_networking_enabled":false,"auxiliary_mode":null,"auxiliary_sku":null,"dns_servers":null,"edge_zone":null,"internal_dns_name_label":null,"ip_configuration":[{"name":"ipconfig1","private_ip_address_allocation":"Dynamic","private_ip_address_version":"IPv4","public_ip_address_id":null}],"ip_forwarding_enabled":false,"location":"westeurope","name":"policyascodedemo-vm-nic","resource_group_name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"sensitive_values":{"applied_dns_servers":[],"ip_configuration":[{}],"private_ip_addresses":[],"tags":{}}},{"address":"azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"location":"westeurope","name":"policyascodedemo-nsg","resource_group_name":"policyascodedemo-rg","security_rule":[{"access":"Allow","description":"","destination_address_prefix":"*","destination_address_prefixes":[],"destination_application_security_group_ids":[],"destination_port_range":"22","destination_port_ranges":[],"direction":"Inbound","name":"allow-ssh-from-anywhere","priority":100,"protocol":"Tcp","source_address_prefix":"*","source_address_prefixes":[],"source_application_security_group_ids":[],"source_port_range":"*","source_port_ranges":[]}],"tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"sensitive_values":{"security_rule":[{"destination_address_prefixes":[],"destination_application_security_group_ids":[],"destination_port_ranges":[],"source_address_prefixes":[],"source_application_security_group_ids":[],"source_port_ranges":[]}],"tags":{}}},{"address":"azurerm_resource_group.rg","mode":"managed","type":"azurerm_resource_group","name":"rg","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"location":"westeurope","managed_by":null,"name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"sensitive_values":{"tags":{}}},{"address":"azurerm_storage_account.sa","mode":"managed","type":"azurerm_storage_account","name":"sa","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":4,"values":{"account_kind":"StorageV2","account_replication_type":"LRS","account_tier":"Standard","allow_nested_items_to_be_public":true,"allowed_copy_scope":null,"azure_files_authentication":[],"cross_tenant_replication_enabled":false,"custom_domain":[],"customer_managed_key":[],"default_to_oauth_authentication":false,"dns_endpoint_type":"Standard","edge_zone":null,"https_traffic_only_enabled":true,"identity":[],"immutability_policy":[],"infrastructure_encryption_enabled":false,"is_hns_enabled":false,"local_user_enabled":true,"location":"westeurope","min_tls_version":"TLS1_2","name":"policyascodedemosa","nfsv3_enabled":false,"provisioned_billing_model_version":null,"public_network_access_enabled":true,"queue_encryption_key_type":"Service","resource_group_name":"policyascodedemo-rg","sas_policy":[],"sftp_enabled":false,"shared_access_key_enabled":true,"table_encryption_key_type":"Service","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"sensitive_values":{"azure_files_authentication":[],"blob_properties":[],"custom_domain":[],"customer_managed_key":[],"identity":[],"immutability_policy":[],"network_rules":[],"primary_access_key":true,"primary_blob_connection_string":true,"primary_connection_string":true,"queue_properties":[],"routing":[],"sas_policy":[],"secondary_access_key":true,"secondary_blob_connection_string":true,"secondary_connection_string":true,"share_properties":[],"static_website":[],"tags":{}}},{"address":"azurerm_subnet.subnet","mode":"managed","type":"azurerm_subnet","name":"subnet","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefixes":["10.10.1.0/24"],"default_outbound_access_enabled":true,"delegation":[],"ip_address_pool":[],"name":"default","private_endpoint_network_policies":"Disabled","private_link_service_network_policies_enabled":true,"resource_group_name":"policyascodedemo-rg","service_endpoint_policy_ids":null,"service_endpoints":null,"timeouts":null,"virtual_network_name":"policyascodedemo-vnet"},"sensitive_values":{"address_prefixes":[false],"delegation":[],"ip_address_pool":[]}},{"address":"azurerm_subnet_network_security_group_association.assoc","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"assoc","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"timeouts":null},"sensitive_values":{}},{"address":"azurerm_virtual_network.vnet","mode":"managed","type":"azurerm_virtual_network","name":"vnet","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_space":["10.10.0.0/16"],"bgp_community":null,"ddos_protection_plan":[],"edge_zone":null,"encryption":[],"flow_timeout_in_minutes":null,"ip_address_pool":[],"location":"westeurope","name":"policyascodedemo-vnet","private_endpoint_vnet_policies":"Disabled","resource_group_name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"sensitive_values":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":[],"encryption":[],"ip_address_pool":[],"subnet":[],"tags":{}}}]}},"resource_changes":[{"address":"azurerm_key_vault.kv","mode":"managed","type":"azurerm_key_vault","name":"kv","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"enable_rbac_authorization":null,"enabled_for_deployment":null,"enabled_for_disk_encryption":null,"enabled_for_template_deployment":null,"location":"westeurope","name":"policyascodedemo-kv","network_acls":[{"bypass":"AzureServices","default_action":"Allow","ip_rules":null,"virtual_network_subnet_ids":null}],"public_network_access_enabled":true,"purge_protection_enabled":false,"resource_group_name":"policyascodedemo-rg","sku_name":"standard","soft_delete_retention_days":90,"tags":{"phase":"insecure","project":"policy-as-code-demo"},"tenant_id":"5318eefe-8bca-4f0f-a115-d1a32583e5e9","timeouts":null},"after_unknown":{"access_policy":true,"contact":true,"id":true,"network_acls":[{}],"tags":{},"vault_uri":true},"before_sensitive":false,"after_sensitive":{"access_policy":[],"contact":[],"network_acls":[{}],"tags":{}}}},{"address":"azurerm_key_vault_access_policy.me","mode":"managed","type":"azurerm_key_vault_access_policy","name":"me","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"application_id":null,"certificate_permissions":null,"key_permissions":null,"object_id":"64605817-ce31-4aee-b339-acb85b45dea0","secret_permissions":["Get","Set","List","Delete"],"storage_permissions":null,"tenant_id":"5318eefe-8bca-4f0f-a115-d1a32583e5e9","timeouts":null},"after_unknown":{"id":true,"key_vault_id":true,"secret_permissions":[false,false,false,false]},"before_sensitive":false,"after_sensitive":{"secret_permissions":[false,false,false,false]}}},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"additional_capabilities":[],"admin_password":"P@ssword1234!","admin_ssh_key":[],"admin_username":"azureuser","allow_extension_operations":true,"availability_set_id":null,"boot_diagnostics":[],"bypass_platform_safety_checks_on_user_schedule_enabled":false,"capacity_reservation_group_id":null,"custom_data":null,"dedicated_host_group_id":null,"dedicated_host_id":null,"disable_password_authentication":false,"edge_zone":null,"encryption_at_host_enabled":null,"eviction_policy":null,"extensions_time_budget":"PT1H30M","gallery_application":[],"identity":[],"license_type":null,"location":"westeurope","max_bid_price":-1,"name":"policyascodedemo-vm","os_disk":[{"caching":"ReadWrite","diff_disk_settings":[],"disk_encryption_set_id":null,"secure_vm_disk_encryption_set_id":null,"security_encryption_type":null,"storage_account_type":"Standard_LRS","write_accelerator_enabled":false}],"os_image_notification":[],"patch_assessment_mode":"ImageDefault","patch_mode":"ImageDefault","plan":[],"platform_fault_domain":-1,"priority":"Regular","provision_vm_agent":true,"proximity_placement_group_id":null,"reboot_setting":null,"resource_group_name":"policyascodedemo-rg","secret":[],"secure_boot_enabled":null,"size":"Standard_B1s","source_image_id":null,"source_image_reference":[{"offer":"0001-com-ubuntu-server-jammy","publisher":"Canonical","sku":"22_04-lts","version":"latest"}],"tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null,"user_data":null,"virtual_machine_scale_set_id":null,"vtpm_enabled":null,"zone":null},"after_unknown":{"additional_capabilities":[],"admin_ssh_key":[],"boot_diagnostics":[],"computer_name":true,"disk_controller_type":true,"gallery_application":[],"id":true,"identity":[],"network_interface_ids":true,"os_disk":[{"diff_disk_settings":[],"disk_size_gb":true,"id":true,"name":true}],"os_image_notification":[],"plan":[],"private_ip_address":true,"private_ip_addresses":true,"public_ip_address":true,"public_ip_addresses":true,"secret":[],"source_image_reference":[{}],"tags":{},"termination_notification":true,"virtual_machine_id":true,"vm_agent_platform_updates_enabled":true},"before_sensitive":false,"after_sensitive":{"additional_capabilities":[],"admin_password":true,"admin_ssh_key":[],"boot_diagnostics":[],"custom_data":true,"gallery_application":[],"identity":[],"network_interface_ids":[],"os_disk":[{"diff_disk_settings":[]}],"os_image_notification":[],"plan":[],"private_ip_addresses":[],"public_ip_addresses":[],"secret":[],"source_image_reference":[{}],"tags":{},"termination_notification":[]}}},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"accelerated_networking_enabled":false,"auxiliary_mode":null,"auxiliary_sku":null,"dns_servers":null,"edge_zone":null,"internal_dns_name_label":null,"ip_configuration":[{"name":"ipconfig1","private_ip_address_allocation":"Dynamic","private_ip_address_version":"IPv4","public_ip_address_id":null}],"ip_forwarding_enabled":false,"location":"westeurope","name":"policyascodedemo-vm-nic","resource_group_name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"after_unknown":{"applied_dns_servers":true,"id":true,"internal_domain_name_suffix":true,"ip_configuration":[{"gateway_load_balancer_frontend_ip_configuration_id":true,"primary":true,"private_ip_address":true,"subnet_id":true}],"mac_address":true,"private_ip_address":true,"private_ip_addresses":true,"tags":{},"virtual_machine_id":true},"before_sensitive":false,"after_sensitive":{"applied_dns_servers":[],"ip_configuration":[{}],"private_ip_addresses":[],"tags":{}}}},{"address":"azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"location":"westeurope","name":"policyascodedemo-nsg","resource_group_name":"policyascodedemo-rg","security_rule":[{"access":"Allow","description":"","destination_address_prefix":"*","destination_address_prefixes":[],"destination_application_security_group_ids":[],"destination_port_range":"22","destination_port_ranges":[],"direction":"Inbound","name":"allow-ssh-from-anywhere","priority":100,"protocol":"Tcp","source_address_prefix":"*","source_address_prefixes":[],"source_application_security_group_ids":[],"source_port_range":"*","source_port_ranges":[]}],"tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"after_unknown":{"id":true,"security_rule":[{"destination_address_prefixes":[],"destination_application_security_group_ids":[],"destination_port_ranges":[],"source_address_prefixes":[],"source_application_security_group_ids":[],"source_port_ranges":[]}],"tags":{}},"before_sensitive":false,"after_sensitive":{"security_rule":[{"destination_address_prefixes":[],"destination_application_security_group_ids":[],"destination_port_ranges":[],"source_address_prefixes":[],"source_application_security_group_ids":[],"source_port_ranges":[]}],"tags":{}}}},{"address":"azurerm_resource_group.rg","mode":"managed","type":"azurerm_resource_group","name":"rg","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"location":"westeurope","managed_by":null,"name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"after_unknown":{"id":true,"tags":{}},"before_sensitive":false,"after_sensitive":{"tags":{}}}},{"address":"azurerm_storage_account.sa","mode":"managed","type":"azurerm_storage_account","name":"sa","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"account_kind":"StorageV2","account_replication_type":"LRS","account_tier":"Standard","allow_nested_items_to_be_public":true,"allowed_copy_scope":null,"azure_files_authentication":[],"cross_tenant_replication_enabled":false,"custom_domain":[],"customer_managed_key":[],"default_to_oauth_authentication":false,"dns_endpoint_type":"Standard","edge_zone":null,"https_traffic_only_enabled":true,"identity":[],"immutability_policy":[],"infrastructure_encryption_enabled":false,"is_hns_enabled":false,"local_user_enabled":true,"location":"westeurope","min_tls_version":"TLS1_2","name":"policyascodedemosa","nfsv3_enabled":false,"provisioned_billing_model_version":null,"public_network_access_enabled":true,"queue_encryption_key_type":"Service","resource_group_name":"policyascodedemo-rg","sas_policy":[],"sftp_enabled":false,"shared_access_key_enabled":true,"table_encryption_key_type":"Service","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"after_unknown":{"access_tier":true,"azure_files_authentication":[],"blob_properties":true,"custom_domain":[],"customer_managed_key":[],"id":true,"identity":[],"immutability_policy":[],"large_file_share_enabled":true,"network_rules":true,"primary_access_key":true,"primary_blob_connection_string":true,"primary_blob_endpoint":true,"primary_blob_host":true,"primary_blob_internet_endpoint":true,"primary_blob_internet_host":true,"primary_blob_microsoft_endpoint":true,"primary_blob_microsoft_host":true,"primary_connection_string":true,"primary_dfs_endpoint":true,"primary_dfs_host":true,"primary_dfs_internet_endpoint":true,"primary_dfs_internet_host":true,"primary_dfs_microsoft_endpoint":true,"primary_dfs_microsoft_host":true,"primary_file_endpoint":true,"primary_file_host":true,"primary_file_internet_endpoint":true,"primary_file_internet_host":true,"primary_file_microsoft_endpoint":true,"primary_file_microsoft_host":true,"primary_location":true,"primary_queue_endpoint":true,"primary_queue_host":true,"primary_queue_microsoft_endpoint":true,"primary_queue_microsoft_host":true,"primary_table_endpoint":true,"primary_table_host":true,"primary_table_microsoft_endpoint":true,"primary_table_microsoft_host":true,"primary_web_endpoint":true,"primary_web_host":true,"primary_web_internet_endpoint":true,"primary_web_internet_host":true,"primary_web_microsoft_endpoint":true,"primary_web_microsoft_host":true,"queue_properties":true,"routing":true,"sas_policy":[],"secondary_access_key":true,"secondary_blob_connection_string":true,"secondary_blob_endpoint":true,"secondary_blob_host":true,"secondary_blob_internet_endpoint":true,"secondary_blob_internet_host":true,"secondary_blob_microsoft_endpoint":true,"secondary_blob_microsoft_host":true,"secondary_connection_string":true,"secondary_dfs_endpoint":true,"secondary_dfs_host":true,"secondary_dfs_internet_endpoint":true,"secondary_dfs_internet_host":true,"secondary_dfs_microsoft_endpoint":true,"secondary_dfs_microsoft_host":true,"secondary_file_endpoint":true,"secondary_file_host":true,"secondary_file_internet_endpoint":true,"secondary_file_internet_host":true,"secondary_file_microsoft_endpoint":true,"secondary_file_microsoft_host":true,"secondary_location":true,"secondary_queue_endpoint":true,"secondary_queue_host":true,"secondary_queue_microsoft_endpoint":true,"secondary_queue_microsoft_host":true,"secondary_table_endpoint":true,"secondary_table_host":true,"secondary_table_microsoft_endpoint":true,"secondary_table_microsoft_host":true,"secondary_web_endpoint":true,"secondary_web_host":true,"secondary_web_internet_endpoint":true,"secondary_web_internet_host":true,"secondary_web_microsoft_endpoint":true,"secondary_web_microsoft_host":true,"share_properties":true,"static_website":true,"tags":{}},"before_sensitive":false,"after_sensitive":{"azure_files_authentication":[],"blob_properties":[],"custom_domain":[],"customer_managed_key":[],"identity":[],"immutability_policy":[],"network_rules":[],"primary_access_key":true,"primary_blob_connection_string":true,"primary_connection_string":true,"queue_properties":[],"routing":[],"sas_policy":[],"secondary_access_key":true,"secondary_blob_connection_string":true,"secondary_connection_string":true,"share_properties":[],"static_website":[],"tags":{}}}},{"address":"azurerm_subnet.subnet","mode":"managed","type":"azurerm_subnet","name":"subnet","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"address_prefixes":["10.10.1.0/24"],"default_outbound_access_enabled":true,"delegation":[],"ip_address_pool":[],"name":"default","private_endpoint_network_policies":"Disabled","private_link_service_network_policies_enabled":true,"resource_group_name":"policyascodedemo-rg","service_endpoint_policy_ids":null,"service_endpoints":null,"timeouts":null,"virtual_network_name":"policyascodedemo-vnet"},"after_unknown":{"address_prefixes":[false],"delegation":[],"id":true,"ip_address_pool":[]},"before_sensitive":false,"after_sensitive":{"address_prefixes":[false],"delegation":[],"ip_address_pool":[]}}},{"address":"azurerm_subnet_network_security_group_association.assoc","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"assoc","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"id":true,"network_security_group_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"azurerm_virtual_network.vnet","mode":"managed","type":"azurerm_virtual_network","name":"vnet","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"address_space":["10.10.0.0/16"],"bgp_community":null,"ddos_protection_plan":[],"edge_zone":null,"encryption":[],"flow_timeout_in_minutes":null,"ip_address_pool":[],"location":"westeurope","name":"policyascodedemo-vnet","private_endpoint_vnet_policies":"Disabled","resource_group_name":"policyascodedemo-rg","tags":{"phase":"insecure","project":"policy-as-code-demo"},"timeouts":null},"after_unknown":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":true,"encryption":[],"guid":true,"id":true,"ip_address_pool":[],"subnet":true,"tags":{}},"before_sensitive":false,"after_sensitive":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":[],"encryption":[],"ip_address_pool":[],"subnet":[],"tags":{}}}}],"output_changes":{"key_vault_name":{"actions":["no-op"],"before":"policyascodedemo-kv","after":"policyascodedemo-kv","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"resource_group":{"actions":["no-op"],"before":"policyascodedemo-rg","after":"policyascodedemo-rg","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"storage_account_name":{"actions":["no-op"],"before":"policyascodedemosa","after":"policyascodedemosa","after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.8.5","values":{"outputs":{"key_vault_name":{"sensitive":false,"value":"policyascodedemo-kv","type":"string"},"resource_group":{"sensitive":false,"value":"policyascodedemo-rg","type":"string"},"storage_account_name":{"sensitive":false,"value":"policyascodedemosa","type":"string"}},"root_module":{"resources":[{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"client_id":"9afd19e1-f940-4fb2-bb0f-f770d9582956","id":"Y2xpZW50Q29uZmlncy9jbGllbnRJZD05YWZkMTllMS1mOTQwLTRmYjItYmIwZi1mNzcwZDk1ODI5NTY7b2JqZWN0SWQ9NjQ2MDU4MTctY2UzMS00YWVlLWIzMzktYWNiODViNDVkZWEwO3N1YnNjcmlwdGlvbklkPTNmZTk3MGI1LTcyMjctNDBlYy1iNGNlLWM3N2VmNGVmZmZiNjt0ZW5hbnRJZD01MzE4ZWVmZS04YmNhLTRmMGYtYTExNS1kMWEzMjU4M2U1ZTk=","object_id":"64605817-ce31-4aee-b339-acb85b45dea0","subscription_id":"3fe970b5-7227-40ec-b4ce-c77ef4efffb6","tenant_id":"5318eefe-8bca-4f0f-a115-d1a32583e5e9","timeouts":null},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"azuread":{"name":"azuread","full_name":"registry.terraform.io/hashicorp/azuread","version_constraint":"~\u003e 2.47.0"},"azurerm":{"name":"azurerm","full_name":"registry.terraform.io/hashicorp/azurerm","expressions":{"client_id":{"constant_value":"9afd19e1-f940-4fb2-bb0f-f770d9582956"},"client_secret":{"constant_value":"P328Q~9ULvXWWBU5WF0NYftDs_fH4~lKNqbwXadB"},"features":[{}],"subscription_id":{"constant_value":"3fe970b5-7227-40ec-b4ce-c77ef4efffb6"},"tenant_id":{"constant_value":"5318eefe-8bca-4f0f-a115-d1a32583e5e9"}}}},"root_module":{"outputs":{"key_vault_name":{"expression":{"references":["azurerm_key_vault.kv.name","azurerm_key_vault.kv"]}},"resource_group":{"expression":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]}},"storage_account_name":{"expression":{"references":["azurerm_storage_account.sa.name","azurerm_storage_account.sa"]}}},"resources":[{"address":"azurerm_key_vault.kv","mode":"managed","type":"azurerm_key_vault","name":"kv","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"name":{"references":["var.prefix"]},"network_acls":[{"bypass":{"constant_value":"AzureServices"},"default_action":{"constant_value":"Allow"}}],"public_network_access_enabled":{"constant_value":true},"purge_protection_enabled":{"constant_value":false},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"sku_name":{"constant_value":"standard"},"tags":{"references":["var.tags"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":2},{"address":"azurerm_key_vault_access_policy.me","mode":"managed","type":"azurerm_key_vault_access_policy","name":"me","provider_config_key":"azurerm","expressions":{"key_vault_id":{"references":["azurerm_key_vault.kv.id","azurerm_key_vault.kv"]},"object_id":{"references":["data.azurerm_client_config.current.object_id","data.azurerm_client_config.current"]},"secret_permissions":{"constant_value":["Get","Set","List","Delete"]},"tenant_id":{"references":["data.azurerm_client_config.current.tenant_id","data.azurerm_client_config.current"]}},"schema_version":0},{"address":"azurerm_linux_virtual_machine.vm","mode":"managed","type":"azurerm_linux_virtual_machine","name":"vm","provider_config_key":"azurerm","expressions":{"admin_password":{"references":["var.insecure_admin_password"]},"admin_username":{"constant_value":"azureuser"},"disable_password_authentication":{"constant_value":false},"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"name":{"references":["var.prefix"]},"network_interface_ids":{"references":["azurerm_network_interface.vm.id","azurerm_network_interface.vm"]},"os_disk":[{"caching":{"constant_value":"ReadWrite"},"storage_account_type":{"constant_value":"Standard_LRS"}}],"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"size":{"constant_value":"Standard_B1s"},"source_image_reference":[{"offer":{"constant_value":"0001-com-ubuntu-server-jammy"},"publisher":{"constant_value":"Canonical"},"sku":{"constant_value":"22_04-lts"},"version":{"constant_value":"latest"}}],"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_network_interface.vm","mode":"managed","type":"azurerm_network_interface","name":"vm","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"constant_value":"ipconfig1"},"private_ip_address_allocation":{"constant_value":"Dynamic"},"subnet_id":{"references":["azurerm_subnet.subnet.id","azurerm_subnet.subnet"]}}],"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"name":{"references":["var.prefix"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_config_key":"azurerm","expressions":{"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"name":{"references":["var.prefix"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"security_rule":{"constant_value":[{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"22","destination_port_ranges":null,"direction":"Inbound","name":"allow-ssh-from-anywhere","priority":100,"protocol":"Tcp","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null}]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_resource_group.rg","mode":"managed","type":"azurerm_resource_group","name":"rg","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.prefix"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"azurerm_storage_account.sa","mode":"managed","type":"azurerm_storage_account","name":"sa","provider_config_key":"azurerm","expressions":{"account_replication_type":{"constant_value":"LRS"},"account_tier":{"constant_value":"Standard"},"allow_nested_items_to_be_public":{"constant_value":true},"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"min_tls_version":{"constant_value":"TLS1_2"},"name":{"references":["var.prefix"]},"public_network_access_enabled":{"constant_value":true},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]}},"schema_version":4},{"address":"azurerm_subnet.subnet","mode":"managed","type":"azurerm_subnet","name":"subnet","provider_config_key":"azurerm","expressions":{"address_prefixes":{"constant_value":["10.10.1.0/24"]},"name":{"constant_value":"default"},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"virtual_network_name":{"references":["azurerm_virtual_network.vnet.name","azurerm_virtual_network.vnet"]}},"schema_version":0},{"address":"azurerm_subnet_network_security_group_association.assoc","mode":"managed","type":"azurerm_subnet_network_security_group_association","name":"assoc","provider_config_key":"azurerm","expressions":{"network_security_group_id":{"references":["azurerm_network_security_group.nsg.id","azurerm_network_security_group.nsg"]},"subnet_id":{"references":["azurerm_subnet.subnet.id","azurerm_subnet.subnet"]}},"schema_version":0},{"address":"azurerm_virtual_network.vnet","mode":"managed","type":"azurerm_virtual_network","name":"vnet","provider_config_key":"azurerm","expressions":{"address_space":{"constant_value":["10.10.0.0/16"]},"location":{"references":["azurerm_resource_group.rg.location","azurerm_resource_group.rg"]},"name":{"references":["var.prefix"]},"resource_group_name":{"references":["azurerm_resource_group.rg.name","azurerm_resource_group.rg"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"data.azurerm_client_config.current","mode":"data","type":"azurerm_client_config","name":"current","provider_config_key":"azurerm","schema_version":0}],"variables":{"insecure_admin_password":{"default":"P@ssword1234!","description":"Demo-only VM password (intentionally weak-ish for password-auth demo)","sensitive":true},"location":{"default":"westeurope","description":"Azure region"},"prefix":{"default":"policyascodedemo","description":"Short, unique prefix for resource names (3-8 chars)"},"tags":{"default":{"phase":"insecure","project":"policy-as-code-demo"}}}}},"relevant_attributes":[{"resource":"azurerm_network_interface.vm","attribute":["id"]},{"resource":"data.azurerm_client_config.current","attribute":["tenant_id"]},{"resource":"azurerm_resource_group.rg","attribute":["location"]},{"resource":"data.azurerm_client_config.current","attribute":["object_id"]},{"resource":"azurerm_key_vault.kv","attribute":["id"]},{"resource":"azurerm_virtual_network.vnet","attribute":["name"]},{"resource":"azurerm_network_security_group.nsg","attribute":["id"]},{"resource":"azurerm_subnet.subnet","attribute":["id"]},{"resource":"azurerm_resource_group.rg","attribute":["name"]}],"timestamp":"2025-08-16T10:18:23Z","applyable":true,"complete":true,"errored":false}
